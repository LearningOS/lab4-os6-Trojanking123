# rcore 总结报告

2022/08/02 把lab4 的文件系统实验做完作为第一阶段的小结，后面后续的实验可能后续会继续跟进。
再这一过程中学习了很多，但仍然有很多不明白的地方。但已经不妨碍我自主进行探索了。

## Rust
通过本项目让我对rust的理解更加深入，也学习到了unsafe rust 的用法。本项目中，rust 编译过后基本无bug，而且全程丰富的代码提示强化了我再学习rust这条路上的决心。

## rcore

这次一共完成了四个作业，内容以了解os基本原理及实现的基础上，实现syscall 为主。分别是ch3 的获取进程信息，ch4 的 map 和 unmap ，ch5的spawn和 stride调度算法，ch5 的 link，unlink，fstat 调用。

### lab1
了解了裸机rust 的构建，kernel 的内存布局，以及启动的基本只是。

另外还有，通过ld脚本向elf 文件里面加标识，然后在rust里面通过声明unsafe 函数，进而定位标签位置的操作让人耳目一新。

另外对elf文件布局及ld脚本都有了新的认识。

### lab2

主要讲述了kernel与用户态的切换。
学习了risc-v处理器如何处理U态与S态的转换，其中各个寄存器的作用，我们应当如何保存上下文，用户栈和内核栈中的灵活切换，rust 中内联汇编的语法等

### lab3

lab2 中程序是依次执行的，而lab3 中实现了各个程序之间的互相切换，即分时任务。

学习了risc-v 时钟中断，及我个人觉得最难的trap 流的切换，即当kernel 态与user态切换与user态互相切换的交融。这里很复杂，需要经常回顾。

另外这个章节引入了tcb对进程进行管理，模块化更好，并且方便了以后的管理及控制。

### lab4

实现了虚拟地址，与物理地址的转化。如读取elf 文件，按照段读入到memoryset 然后，每个程序维护个pagetable，切换任务的时候重新设置root ppn，然后物理硬件实现转化。不过本章还是提前把elf 文件load 的内存中的，没有除了缺页的情况。学习了sv39 地址转换的硬件原理。

### lab5 

lab5 相对比较简单，spawn 调用，相当于fork 和 exec 调用的结合。只是需要注意调用fork 后代用exec 时需要对某系记录重新初始化一下。
stride 调度的话，只需要找到调度的入口，然后修改pass值，重新把task manager 的 内置数据结构改成 priority heap 就行了

### lab6 

文件系统，最“平常”的一章，因为文件系统是可以通过用户态程序调试，给人的感觉就像写用户态程序一样。但还是让我学习到了磁盘布局，缓存等只是。另外通过block  device 来实现模块化，是一个很厉害的点子。



**总结完毕，谢谢各位老师同学同志的帮助**






